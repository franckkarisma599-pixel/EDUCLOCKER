<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tableau de bord - Étudiant Locker</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        .dashboard {
            padding: 40px 0;
        }
        
        .welcome-message {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: var(--border-radius);
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: var(--box-shadow);
        }
        
        .welcome-message h1 {
            color: white;
            margin-bottom: 10px;
        }
        
        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .stat-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
            display: flex;
            align-items: center;
            gap: 20px;
            transition: var(--transition);
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }
        
        .stat-icon.documents {
            background-color: var(--primary-color);
        }
        
        .stat-icon.quizzes {
            background-color: var(--success-color);
        }
        
        .stat-icon.reminders {
            background-color: var(--warning-color);
        }
        
        .stat-icon.score {
            background-color: var(--accent-color);
        }
        
        .dashboard-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
        }
        
        @media (max-width: 992px) {
            .dashboard-content {
                grid-template-columns: 1fr;
            }
        }
        
        .recent-activity, .upcoming-reminders {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 25px;
        }
        
        .activity-list, .reminders-list {
            margin-top: 20px;
        }
        
        .activity-item, .reminder-item {
            display: flex;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #eee;
        }
        
        .activity-item:last-child, .reminder-item:last-child {
            border-bottom: none;
        }
        
        .activity-icon, .reminder-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            color: white;
            flex-shrink: 0;
        }
        
        .activity-icon.quiz {
            background: var(--success-color);
        }
        
        .activity-icon.document {
            background: var(--primary-color);
        }
        
        .activity-icon.reminder {
            background: var(--warning-color);
        }
        
        .reminder-icon {
            background: var(--accent-color);
        }
        
        .activity-details, .reminder-details {
            flex: 1;
        }
        
        .activity-title, .reminder-title {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .activity-time, .reminder-time {
            color: var(--gray-color);
            font-size: 0.9rem;
        }
        
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .action-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
            text-align: center;
            transition: var(--transition);
        }
        
        .action-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .action-icon {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .action-card h3 {
            margin-bottom: 10px;
        }
        
        .action-card p {
            color: var(--gray-color);
            margin-bottom: 20px;
        }
        
        .empty-message {
            text-align: center;
            padding: 30px 20px;
            color: var(--gray-color);
        }
        
        .empty-message i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: #dee2e6;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <a href="index.html" class="logo">
                <i class="fas fa-graduation-cap"></i>
                <span>Éduc</span>Locker
            </a>
            
            <div class="nav-links">
                <a href="index.html"><i class="fas fa-home"></i> Accueil</a>
                <a href="dashboard.html" class="active"><i class="fas fa-tachometer-alt"></i> Tableau de bord</a>
                <a href="cours.html"><i class="fas fa-folder"></i> Documents</a>
                <a href="quiz.html"><i class="fas fa-question-circle"></i> Quiz</a>
                <a href="reminders.html"><i class="fas fa-bell"></i> Rappels</a>
                <a href="profile.html"><i class="fas fa-user"></i> Profil</a>
            </div>
            
            <button class="menu-toggle">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </nav>

    <!-- Dashboard -->
    <section class="dashboard">
        <div class="container">
            <!-- Message de bienvenue -->
            <div class="welcome-message">
                <h1>Bonjour, <span class="user-name">Étudiant</span> !</h1>
                <p>Voici un résumé de votre activité sur la plateforme.</p>
                <p id="currentDate" style="margin-top: 10px; opacity: 0.9;"></p>
            </div>
            
            <!-- Statistiques -->
            <div class="dashboard-stats">
                <div class="stat-card">
                    <div class="stat-icon documents">
                        <i class="fas fa-folder"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="documentsCount">0</h3>
                        <p>Documents sauvegardés</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon quizzes">
                        <i class="fas fa-question-circle"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="quizzesCount">0</h3>
                        <p>Quiz complétés</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon reminders">
                        <i class="fas fa-bell"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="remindersCount">0</h3>
                        <p>Rappels actifs</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon score">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="averageScore">0%</h3>
                        <p>Score moyen aux quiz</p>
                    </div>
                </div>
            </div>
            
            <!-- Contenu principal -->
            <div class="dashboard-content">
                <!-- Activité récente -->
                <div class="recent-activity">
                    <h2>Activité récente</h2>
                    <div class="activity-list" id="activityList">
                        <!-- Les activités seront insérées ici par JavaScript -->
                        <div class="empty-message">
                            <i class="fas fa-history"></i>
                            <p>Aucune activité récente</p>
                        </div>
                    </div>
                </div>
                
                <!-- Rappels à venir -->
                <div class="upcoming-reminders">
                    <h2>Rappels à venir</h2>
                    <div class="reminders-list" id="upcomingRemindersList">
                        <!-- Les rappels seront insérés ici par JavaScript -->
                        <div class="empty-message">
                            <i class="fas fa-bell-slash"></i>
                            <p>Aucun rappel à venir</p>
                        </div>
                    </div>
                    <a href="reminders.html" class="btn-secondary" style="display: block; margin-top: 20px; text-align: center;">
                        <i class="fas fa-plus"></i> Ajouter un rappel
                    </a>
                </div>
            </div>
            
            <!-- Actions rapides -->
            <div class="quick-actions">
                <div class="action-card">
                    <div class="action-icon">
                        <i class="fas fa-upload"></i>
                    </div>
                    <h3>Uploader un document</h3>
                    <p>Ajoutez vos cours et documents pour les sauvegarder en toute sécurité.</p>
                    <a href="cours.html" class="btn-primary">Commencer</a>
                </div>
                
                <div class="action-card">
                    <div class="action-icon">
                        <i class="fas fa-question-circle"></i>
                    </div>
                    <h3>Faire un quiz</h3>
                    <p>Testez vos connaissances avec nos quiz par matière.</p>
                    <a href="quiz.html" class="btn-primary">Commencer</a>
                </div>
                
                <div class="action-card">
                    <div class="action-icon">
                        <i class="fas fa-bell"></i>
                    </div>
                    <h3>Gérer les rappels</h3>
                    <p>Configurez des rappels pour vos révisions et examens.</p>
                    <a href="reminders.html" class="btn-primary">Commencer</a>
                </div>
                
                <div class="action-card">
                    <div class="action-icon">
                        <i class="fas fa-chart-bar"></i>
                    </div>
                    <h3>Voir la progression</h3>
                    <p>Consultez vos statistiques et suivez vos progrès.</p>
                    <a href="profile.html" class="btn-primary">Commencer</a>
                </div>
            </div>
        </div>
    </section>

    <script src="js/main.js"></script>
    <script>
        // Dashboard
        document.addEventListener('DOMContentLoaded', function() {
            // Mettre à jour la date
            const now = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('currentDate').textContent = now.toLocaleDateString('fr-FR', options);
            
            // Charger les statistiques
            loadDashboardStats();
            loadRecentActivity();
            loadUpcomingReminders();
        });
        
        function loadDashboardStats() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            if (!currentUser) return;
            
            // Documents
            const allDocuments = JSON.parse(localStorage.getItem('documents')) || {};
            const userDocuments = allDocuments[currentUser.email] || [];
            document.getElementById('documentsCount').textContent = userDocuments.length;
            
            // Quiz
            const quizResults = JSON.parse(localStorage.getItem('quizResults')) || {};
            const userQuizResults = quizResults[currentUser.email] || [];
            document.getElementById('quizzesCount').textContent = userQuizResults.length;
            
            // Score moyen
            let totalScore = 0;
            userQuizResults.forEach(result => {
                totalScore += result.percentage;
            });
            const averageScore = userQuizResults.length > 0 ? (totalScore / userQuizResults.length).toFixed(0) : 0;
            document.getElementById('averageScore').textContent = `${averageScore}%`;
            
            // Rappels
            const reminders = JSON.parse(localStorage.getItem('reminders')) || {};
            const userReminders = reminders[currentUser.email] || [];
            const activeReminders = userReminders.filter(r => r.status === 'upcoming').length;
            document.getElementById('remindersCount').textContent = activeReminders;
        }
        
        function loadRecentActivity() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            if (!currentUser) return;
            
            const activities = [];
            
            // Récupérer les activités des quiz
            const quizResults = JSON.parse(localStorage.getItem('quizResults')) || {};
            const userQuizResults = quizResults[currentUser.email] || [];
            
            userQuizResults.slice(-5).forEach(result => {
                activities.push({
                    type: 'quiz',
                    title: `Quiz ${result.subject} terminé`,
                    details: `Score: ${result.percentage}%`,
                    time: result.date,
                    icon: 'quiz'
                });
            });
            
            // Récupérer les activités des documents
            const allDocuments = JSON.parse(localStorage.getItem('documents')) || {};
            const userDocuments = allDocuments[currentUser.email] || [];
            
            userDocuments.slice(-3).forEach(doc => {
                activities.push({
                    type: 'document',
                    title: `Document uploadé: ${doc.name}`,
                    details: doc.subject,
                    time: doc.uploadDate,
                    icon: 'document'
                });
            });
            
            // Récupérer les activités des rappels
            const reminders = JSON.parse(localStorage.getItem('reminders')) || {};
            const userReminders = reminders[currentUser.email] || [];
            
            userReminders.filter(r => r.status === 'completed').slice(-2).forEach(reminder => {
                activities.push({
                    type: 'reminder',
                    title: `Rappel complété: ${reminder.title}`,
                    details: reminder.type,
                    time: reminder.createdAt,
                    icon: 'reminder'
                });
            });
            
            // Trier par date (les plus récents en premier)
            activities.sort((a, b) => new Date(b.time) - new Date(a.time));
            
            // Afficher les activités
            const activityList = document.getElementById('activityList');
            
            if (activities.length === 0) {
                activityList.innerHTML = `
                    <div class="empty-message">
                        <i class="fas fa-history"></i>
                        <p>Aucune activité récente</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            
            activities.slice(0, 5).forEach(activity => {
                const time = new Date(activity.time);
                const timeFormatted = time.toLocaleDateString('fr-FR') + ' à ' + time.toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' });
                
                html += `
                    <div class="activity-item">
                        <div class="activity-icon ${activity.icon}">
                            <i class="fas fa-${activity.icon === 'quiz' ? 'question-circle' : activity.icon === 'document' ? 'file' : 'bell'}"></i>
                        </div>
                        <div class="activity-details">
                            <div class="activity-title">${activity.title}</div>
                            <div class="activity-details">${activity.details}</div>
                            <div class="activity-time">${timeFormatted}</div>
                        </div>
                    </div>
                `;
            });
            
            activityList.innerHTML = html;
        }
        
        function loadUpcomingReminders() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            if (!currentUser) return;
            
            const reminders = JSON.parse(localStorage.getItem('reminders')) || {};
            const userReminders = reminders[currentUser.email] || [];
            
            // Filtrer les rappels à venir
            const upcomingReminders = userReminders
                .filter(r => r.status === 'upcoming')
                .sort((a, b) => {
                    const dateA = new Date(`${a.date}T${a.time}`);
                    const dateB = new Date(`${b.date}T${b.time}`);
                    return dateA - dateB;
                })
                .slice(0, 3);
            
            // Afficher les rappels
            const remindersList = document.getElementById('upcomingRemindersList');
            
            if (upcomingReminders.length === 0) {
                remindersList.innerHTML = `
                    <div class="empty-message">
                        <i class="fas fa-bell-slash"></i>
                        <p>Aucun rappel à venir</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            
            upcomingReminders.forEach(reminder => {
                const date = new Date(`${reminder.date}T${reminder.time}`);
                const dateFormatted = date.toLocaleDateString('fr-FR', { weekday: 'short', day: 'numeric', month: 'short' });
                const timeFormatted = date.toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' });
                
                html += `
                    <div class="reminder-item">
                        <div class="reminder-icon">
                            <i class="fas fa-bell"></i>
                        </div>
                        <div class="reminder-details">
                            <div class="reminder-title">${reminder.title}</div>
                            <div class="reminder-time">${dateFormatted} à ${timeFormatted}</div>
                        </div>
                    </div>
                `;
            });
            
            remindersList.innerHTML = html;
        }
    </script>
</body>
</html><div class="action-card">
    <div class="action-icon">
        <i class="fas fa-book"></i>
    </div>
    <h3>Écrire un cours</h3>
    <p>Enregistrez vos notes de cours avec notre éditeur intégré.</p>
    <a href="cours.html" class="btn-primary">Commencer</a>
</div>